<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title>Test</title>
		<link rel="stylesheet" type="text/css" href="/css/style.css">
		<link href='https://fonts.googleapis.com/css?family=Open+Sans:300' rel='stylesheet' type='text/css'>
	</head>
	<body>
		<!--<div class="container"> 
	  <div class="gallery">
	  <img id="Hero1" src="/images/heros/crusader_roster.png" alt="Crusader" width="96" height="96">
	  <select
	  </div>
	  <div class="gallery">
	  <img id="Hero2" src="/images/heros/crusader_roster.png" alt="Crusader" width="96" height="96">
	  </div>
	  <div class="gallery">
	  <img id="Hero3"  src="/images/heros/crusader_roster.png" alt="Crusader" width="96" height="96">
	  </div>
	  <div class="gallery">
	  <img id="Hero4" src="/images/heros/crusader_roster.png" alt="Crusader" width="96" height="96">
	  </div>
	  </div> -->
	  <div class="hero_form">
		  <div class="gallery">
			  <img id="Hero4" src="/images/heroes/vestal_roster.png" alt="Position Four" width="96" height="96">
		  </div>
		  <div class="gallery">
			  <img id="Hero3" src="/images/heroes/plague_doctor_roster.png" alt="Position Three" width="96" height="96">
		  </div>
		  <div class="gallery">
			  <img id="Hero2" src="/images/heroes/highwayman_roster.png" alt="Position Two" width="96" height="96">
		  </div>
		  <div class="gallery">
			  <img id="Hero1" src="/images/heroes/crusader_roster.png" alt="Position One" width="96" height="96">
		  </div>
		  <br></br>
	  </div>
	  <form class="hero_form" action="/" method="post">
		  <select class="hero_select" name="hero4" id="hero4_select"></select>
		  <select class="hero_select" name="hero3" id="hero3_select"></select>
		  <select class="hero_select" name="hero2" id="hero2_select"></select>
		  <select class="hero_select" name="hero1" id="hero1_select"></select>
		  <br></br>
		  <div class="ability_pane">
			  <div class="ability_pane" id="abil4">
				  <select class="ability_select" name="h4a1" id="hero4_ability1"></select>
				  <select class="ability_select" name="h4a2" id="hero4_ability2"></select>
				  <select class="ability_select" name="h4a3" id="hero4_ability3"></select>
				  <select class="ability_select" name="h4a4" id="hero4_ability4"></select>
			  </div>
		  </div>
		  <div class="ability_pane">
			  <div class="ability_pane" id="abil3">
				  <select class="ability_select" name="h3a1" id="hero3_ability1"></select>
				  <select class="ability_select" name="h3a2" id="hero3_ability2"></select>
				  <select class="ability_select" name="h3a3" id="hero3_ability3"></select>
				  <select class="ability_select" name="h3a4" id="hero3_ability4"></select>
			  </div>
		  </div>
		  <div class="ability_pane">
			  <div class="ability_pane" id="abil2">
				  <select class="ability_select" name="h2a1" id="hero2_ability1"></select>
				  <select class="ability_select" name="h2a2" id="hero2_ability2"></select>
				  <select class="ability_select" name="h2a3" id="hero2_ability3"></select>
				  <select class="ability_select" name="h2a4" id="hero2_ability4"></select>
			  </div>
		  </div>
		  <div class="ability_pane">
			  <div class="ability_pane" id="abil1">
			  </div>
		  </div>
		  <br></br>
		  <input type="submit" class="ghost-button" value="Generate Preview">
	  </form>





	</body>
	<script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
	<script>
		function updateImage(select_id, image_id) {
			hero_name = document.getElementById(select_id).value;
			$.getJSON(herodata, function(data){
				new_img_src = data.heroes[hero_name].image;
				document.getElementById(image_id).src = new_img_src;
			});
		}
function getAbilities(hero_name, callback) {
	$.getJSON(herodata, function(data) {
		callback(data.heroes[hero_name].abilities);
	});
}
function generateAbilitySelection(select_id, ability_pane_id) {
	hero_name = document.getElementById(select_id).value;
	let ability_pane = $('#'+ability_pane_id);
	ability_pane.empty();
	ability_pane.append($('<select></select>').attr({'id': ability_pane_id + "-1", "class": "ability_select"}));
	ability_pane.append($('<select></select>').attr({'id': ability_pane_id + "-2", "class": "ability_select"}));
	ability_pane.append($('<select></select>').attr({'id': ability_pane_id + "-3", "class": "ability_select"}));
	ability_pane.append($('<select></select>').attr({'id': ability_pane_id + "-4", "class": "ability_select"}));
	for( i = 1; i <= 4; i++) {
		let cur_select = ability_pane_id + "-" + i.toString();
		getAbilities(hero_name, function(data) {
			sel = $('#'+cur_select);
			num = 1;
			$.each(data, function(key) {
				console.log(key);
				//		if(num == i) {
				//			sel.append($('<option></option>').attr({'value': key, 'selected': 'selected'}).text(key));
				//		} else {
				sel.append($('<option></option>').attr({'value': key}).text(key));
				//		}
				num++;
			});
		});
	} 
}

$('#hero1_select').change(function(){
	updateImage("hero1_select", "Hero1");
	generateAbilitySelection("hero1_select", "abil1");
	document.getElementById('abil1').style.display='block';
})
$('#hero2_select').change(function(){
	updateImage("hero2_select", "Hero2");
	generateAbilitySelection("hero2_select", "abil2");
	document.getElementById('abil2').style.display='block';

})
$('#hero3_select').change(function(){
	updateImage("hero3_select", "Hero3");
	generateAbilitySelection("hero3_select", "abil3");
	document.getElementById('abil3').style.display='block';

})
$('#hero4_select').change(function(){
	updateImage("hero4_select", "Hero4");
	generateAbilitySelection("hero4_select", "abil4");
	document.getElementById('abil4').style.display='block';

})



	</script>

	<script type=text/javascript>
		const herodata = "/data/heroes.json";
let dropdown1 = $('#hero1_select');
let dropdown2 = $('#hero2_select');
let dropdown3 = $('#hero3_select');
let dropdown4 = $('#hero4_select');

dropdown1.empty();
dropdown2.empty();
dropdown3.empty();
dropdown4.empty();

dropdown1.append('<option selected="true" disabled>Choose Hero</option>');
dropdown2.append('<option selected="true" disabled>Choose Hero</option>');
dropdown3.append('<option selected="true" disabled>Choose Hero</option>');
dropdown4.append('<option selected="true" disabled>Choose Hero</option>');

dropdown1.prop('selectedIndex', 0);
dropdown2.prop('selectedIndex', 0);
dropdown3.prop('selectedIndex', 0);
dropdown4.prop('selectedIndex', 0);


// Populate dropdown with list of provinces
$.getJSON(herodata, function (data) {
	$.each(data.heroes, function (key, entry) {
		dropdown1.append($('<option></option>').attr('value', key).text(key));
		dropdown2.append($('<option></option>').attr('value', key).text(key));
		dropdown3.append($('<option></option>').attr('value', key).text(key));
		dropdown4.append($('<option></option>').attr('value', key).text(key));
	})
});
document.getElementById('abil1').style.display='none';
document.getElementById('abil2').style.display='none';
document.getElementById('abil3').style.display='none';
document.getElementById('abil4').style.display='none';

	</script>
</html>
